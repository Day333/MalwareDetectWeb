# 0 基于机器学习和Flask的恶意URL检测平台

# 1 平台部署过程

平台使用python Flask框架进行网站框架的搭建，部署过程分为三大部分：python环境的搭建、Uwsgi服务器搭建和Nginx服务器反向代理部署

## 1. python环境的搭建

此处使用pyenv虚拟环境指定项目路径

![image-20230728162044501](./pictures/image-20230728162044501.png)

python版本：3.8.2

pip版本：23.0.1

package依赖：requirment.txt中

## 2. Uwsgi服务器的搭建

Uwsgi服务器依赖python环境，利用pip命令导入相关uwsgi依赖包，然后必须要在相应虚拟环境中启动

修改uwsgi相关配置文件

![image-20230728162110313](pictures\image-20230728162110313.png)

启动uwsgi服务，运行Flask启动的python相应文件，访问uwsgi对应的端口进行访问

可成功访问平台页面即部署uwsgi服务成功

## 3. Nginx服务器反向代理

我们利用Nginx服务器反向代理连接uwsgi服务器，进行负载均衡，提升平台的性能水准

安装nginx服务 并修改其配置文件

监听uwsgi映射出的对应端口，将其转发到Nginx服务的80端口

![image-20230728162145728](pictures\image-20230728162145728.png)

## 问题

其中出现的最难解决的问题便是如何将Nginx服务器与Uwsgi服务连接成功

中间出现的问题便是在访问80端口时出现错误，显示了最初的nginx部署界面，而并不是我们想要转发过去的8000端口的flask平台内容

**最终解决原理：**

Nginx和Uwsgi的连接支持两种不同的通信协议：

1. HTTP通信协议

2. Socket通信协议

而我们在部署的时候在两侧服务的协议方法没有相互对应起来，导致通信中断无法进行成功连接

Nginx配置：

![image-20230728162156858](pictures\image-20230728162156858.png)

Uwsgi配置：

![image-20230728162207989](pictures\image-20230728162207989.png)

最终我们将通信协议都改为HTTP协议，实现了最终的转换连接

# 2 展示

![image-20230728155228376](pictures\image-20230728155228376.png)

![image-20230728154829614](pictures\image-20230728154829614.png)

**软件使用说明**

打开浏览器，进入恶意攻击监测平台。

![img](pictures\clip_image002.png)

图1 平台登录页面

(1)  用户注册

用户点击右上角“注册”按钮进入注册页面。

![img](file:///F:/temp/msohtmlclip1/01/clip_image003.png)![img](file:///F:/temp/msohtmlclip1/01/clip_image004.png) ![img](pictures\clip_image005.png)

图2 注册

![img](pictures\clip_image007.png)

图3 注册界面

按照提示框要求在相应位置输入用户名、邮箱、密码、确认密码后获取验证码并填入后，点击“立即注册”，完成用户注册。

(2)  用户登录

输入正确的用户名和密码，点击“登录”按键即可登录

![img](pictures\clip_image009.png)

图4 登录界面

(3)  平台首页

登录成功后进入平台首页，在主菜单选择功能进行恶意攻击监测。

![img](pictures\clip_image011.png)

图5 平台首页

 

(4)  输入检测及反馈

选择对应功能后，进入用户输入页面，输入需要检测的命令行，或上传本地文件，平台将对输入的命令行或上传文件进行检测，并将检测结果反馈至页面“检测结果展示”框内。

![img](pictures\clip_image013.png)

图6 单行命令行检测

![img](pictures\clip_image015.png)

图7上传文件检测

![img](pictures\clip_image017.png)

图8 检测结果展示

(5)  数据下载

平台提供数据下载，点击主菜单中的数据下载将跳转至下载页面，提供本平台用于训练和测试的数据集供有需要的用户查看。

![img](pictures\clip_image019.png)

图8数据下载

(6)  退出登录

当用户需要退出平台时，可以点击右上角用户头像，点击退出登录。

![img](pictures\clip_image021.png)

图9 退出登录
