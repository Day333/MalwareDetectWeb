import joblib
from controller.dataprepare import dataprepare

LGBModel = joblib.load('controller/modeltrain/LotlDetection.pkl')

def getPre(Command_line):
    x_feature = dataprepare(Command_line)
    y_pred = LGBModel.predict(x_feature)
    return y_pred


def getRes(Command_line):
    pre = getPre(Command_line)
    tmp = "非恶意命令行" if pre[0] == 0 else "恶意命令行"
    resList = [Command_line, tmp]
    return resList
